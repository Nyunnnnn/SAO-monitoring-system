
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SAO Student Monitoring System</title>
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
</head>
<body class="bg-gray-100 p-6">
  <!-- Login Modal -->
  <div id="login-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50">
    <div class="bg-white rounded-xl p-6 w-full max-w-sm">
      <h2 class="text-xl font-bold mb-4">Admin Login</h2>
      <input type="text" id="username" placeholder="Username" class="w-full mb-2 p-2 border rounded">
      <input type="password" id="password" placeholder="Password" class="w-full mb-4 p-2 border rounded">
      <button onclick="authenticate()" class="w-full bg-blue-600 text-white py-2 rounded">Login</button>
      <p id="login-error" class="text-red-600 mt-2 hidden">Invalid credentials</p>
    </div>
  </div>

  <!-- Main Content -->
  <div id="app" class="hidden max-w-4xl mx-auto bg-white shadow-md rounded-xl p-6">
    <h1 class="text-2xl font-bold mb-4">SAO Student Monitoring System</h1>

    <!-- QR Code Generator -->
    <div class="mb-6">
      <h2 class="text-lg font-semibold mb-2">Generate QR Code for Student</h2>
      <input type="text" id="qr-input" placeholder="Enter Student ID" class="w-full p-2 border rounded mb-2">
      <button onclick="generateQRCode()" class="bg-green-600 text-white px-4 py-2 rounded">Generate QR</button>
      <div id="qrcode" class="mt-4"></div>
    </div>

    <!-- Barcode Input Option -->
    <div class="mb-4">
      <label class="block mb-1 font-semibold">Scan Manually (for mobile)</label>
      <input type="text" id="manual-scan" placeholder="Enter Student ID" class="w-full p-2 border rounded" onkeypress="handleManualScan(event)">
    </div>

    <div id="reader" class="w-full max-w-md mx-auto mb-4"></div>
    <p id="scan-result" class="text-green-600 font-semibold"></p>

    <!-- Dashboard -->
    <div class="mt-6">
      <h2 class="text-xl font-bold mb-2">Logs</h2>
      <ul id="log-list" class="list-disc pl-5 text-sm text-gray-700"></ul>
    </div>
  </div>

  <script>
    const validUsername = "admin";
    const validPassword = "1234";

    // Dummy student data
    const students = {
      "S2023001": "Juan Dela Cruz",
      "S2023002": "Maria Santos",
      "S2023003": "Jose Rizal",
      "S2023004": "Andres Bonifacio",
      "S2023005": "Gabriela Silang"
    };

    function authenticate() {
      const user = document.getElementById('username').value;
      const pass = document.getElementById('password').value;
      const error = document.getElementById('login-error');
      if (user === validUsername && pass === validPassword) {
        document.getElementById('login-modal').style.display = 'none';
        document.getElementById('app').classList.remove('hidden');
      } else {
        error.classList.remove('hidden');
      }
    }

    const logList = document.getElementById('log-list');
    const scanResult = document.getElementById('scan-result');

    function addLog(studentId) {
      const now = new Date().toLocaleString();
      const studentName = students[studentId] || "Unknown Student";
      const logEntry = `${now} - ${studentName} (ID: ${studentId})`;
      const li = document.createElement('li');
      li.textContent = logEntry;
      logList.prepend(li);
    }

    function onScanSuccess(decodedText, decodedResult) {
      const studentName = students[decodedText] || "Unknown Student";
      scanResult.textContent = `Scanned: ${studentName} (ID: ${decodedText})`;
      addLog(decodedText);
    }

    function handleManualScan(event) {
      if (event.key === 'Enter') {
        const input = event.target.value.trim();
        if (input) {
          const studentName = students[input] || "Unknown Student";
          scanResult.textContent = `Manually Entered: ${studentName} (ID: ${input})`;
          addLog(input);
          event.target.value = '';
        }
      }
    }

    function generateQRCode() {
      const input = document.getElementById('qr-input').value.trim();
      const qrCodeDiv = document.getElementById('qrcode');
      qrCodeDiv.innerHTML = '';
      if (input) {
        QRCode.toCanvas(input, { width: 200 }, function (error, canvas) {
          if (error) console.error(error);
          else qrCodeDiv.appendChild(canvas);
        });
      }
    }

    const html5QrcodeScanner = new Html5QrcodeScanner(
      "reader", { fps: 10, qrbox: 250 });
    html5QrcodeScanner.render(onScanSuccess);
  </script>
</body>
</html>
